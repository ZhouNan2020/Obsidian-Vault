多层索引与pd.panel和pd.panel4D共同构成了pandas处理高维数据的主要对象，但是多层索引的基本结构是稀疏向量，而panel的数据结构是密接矩阵，随着维度的增加，密集矩阵的储存方式会逐渐低效化，因此处理高维数据有限选择多层索引。
多层索引是指在数据结构中将多个不同等级的索引同时应用，从而实现以Series和Dataframe的方式存储与展示高维数据。

pd.MultiIndex是pandas创建多层索引的主要方式，包括from_arrays, from_frame, from_product, from_tuples等多种数据容器对象。
在实际应用时，需要先使用pd.MultiIndex创建多层索引，然后再将此索引传递给Series或DataFrame结构

或者，针对单索引数据结构，使用reindex重置索引，如果传入一个多层级索引的数据容器，则将其单索引结构改变为多索引结构。要求传入的数据容器的索引长度与数据结构中的标量长度一致。例如下
``` python
index=[(california,2020),(california,2010),(new york,2020),(new york,2010),(texas,2020),(texas,2010)]
# 将要传入的index有6个tuple，所以下面对应需要标注索引的标量也需要6个
popluation = [89787,878978,12131,3242314,2324123,132412]
popluation = pd.Series(popluation)
# 重置索引,将index作为索引标签传入
pop = popluation.reindex(index)
# 运行结果可获得一个多层索引的Series
```

多层索引的降维和升维
由于多层索引本质是Series和DataFrame的叠加，所以可以相互转换，使用stack和unstack（可以按照字面意思理解为，码起来和摊开），stack将堆叠索引，即恢复成多层索引+标量数组的形式，unstack将展平索引，恢复成一维或二维的形式。

在多层索引+标量数组的形式下，为数据增加维度几乎等同于为DataFrame增加列。


生成多层索引的过程:
1. 显示创建：
即通过pd.MultiIndex.from_XXXX来创建索引然后传递给数据容器
2. 加上索引名称：
data.index.names=[name1,name2] # str格式
3. 多级行列索引
用于dataframe中行索引和列索引均需多级索引的情况
使用MultiIndex分别创建行索引值和列索引值，然后分别传递给dataframe的index和columns，需要根据数据本身的排列方式，选择合适的索引创建方法。
如果制作多级行列索引时，对于自己的数据结构比较混淆，可以使用直接指定levels和labels（更新后的pandas这个参数名更改为‘codes'，继续按照labels传递参数会报错）
如下
``` python
index=pd.MultiIndex(levels = [['a','b'],[1,2]],codes=[[0,0,1,1],[0,1,0,1]])

data=[[12,13,14,15],[16,17,18,19],[34,56,78,90],[90,67,443,23]]
data = pd.DataFrame(data,index=index)
```

codes参数用于在不同层级规定索引的排列顺序，增加了灵活性。上例中采用笛卡尔积的方式排列（类似常卡方表的形式）。

**多层索引的取值与切片**
1. 针对Series
- Series可以实现按照简单的按照层级，逐级定位取值
- 也可以使用单级索引进行局部取值
- 也可以在同级索引中使用切片，与常规的切片方式一样。
- 直接针对值进行布尔值索引
2. 针对DataFrame
- 使用DF常规的纵横定位索引
- 使用DF常规的iloc、loc和ix索引(在多级索引中，这些函数可以直接传递元组)
- 创建并使用pd.IndexSlice对象(这玩意儿晚点再试)

**区分层级的数据累计方法**
多层索引中一样可以使用mean，sum和max等方法，同时接受以下两种参数
- 索引名：指定需要进行算术操作的索引名称
- 轴：axis=1或0
